{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport axios from 'axios';\nexport let Status;\n\n(function (Status) {\n  Status[\"LOADING\"] = \"loading\";\n  Status[\"FULFILLED\"] = \"success\";\n  Status[\"REJECTED\"] = \"error\";\n})(Status || (Status = {}));\n\nexport const fetchProductBasket = createAsyncThunk('basketSlice/fetchProductBasket', async () => {\n  const {\n    data\n  } = await axios.get('https://62b1bba0196a9e98703c1172.mockapi.io/card');\n  return data;\n});\nconst initialState = {\n  basketItems: [],\n  basketStatus: Status.LOADING,\n  totalPrice: 0\n};\nexport const ProductSlice = createSlice({\n  name: 'product',\n  initialState: initialState,\n  reducers: {\n    setItems: (state, action) => {\n      state.basketItems = action.payload;\n    },\n    addItems: (state, action) => {\n      const obj = action.payload;\n\n      async function fetchAdd() {\n        state.basketItems.push(obj);\n        await axios.post('https://62b1bba0196a9e98703c1172.mockapi.io/card', obj);\n        const {\n          data\n        } = await axios.get('https://62b1bba0196a9e98703c1172.mockapi.io/card');\n        state.basketItems = data;\n      }\n\n      try {\n        fetchAdd();\n      } catch {\n        console.log('None');\n      }\n    },\n    delItems: (state, action) => {\n      const id = action.payload;\n\n      try {\n        axios.delete(`https://62b1bba0196a9e98703c1172.mockapi.io/card/${id}`);\n        state.basketItems = state.basketItems.filter(item => item.id !== id);\n        const {\n          data\n        } = axios.get('https://62b1bba0196a9e98703c1172.mockapi.io/card');\n      } catch {\n        console.log('None');\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchProductBasket.fulfilled, (state, action) => {\n      state.basketItems = action.payload;\n      state.totalPrice = state.basketItems.reduce((sum, obj) => {\n        return sum + obj.price;\n      }, 0);\n      state.basketStatus = Status.FULFILLED;\n    });\n    builder.addCase(fetchProductBasket.pending, (state, action) => {\n      state.basketItems = [];\n      state.basketStatus = Status.LOADING;\n    });\n    builder.addCase(fetchProductBasket.rejected, (state, action) => {\n      state.basketItems = [];\n      state.basketStatus = Status.REJECTED;\n    });\n  }\n});\nexport const {\n  setItems,\n  addItems,\n  delItems\n} = ProductSlice.actions;\nexport const selectBasket = state => state.basket;\nexport default ProductSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","Status","fetchProductBasket","data","get","initialState","basketItems","basketStatus","LOADING","totalPrice","ProductSlice","name","reducers","setItems","state","action","payload","addItems","obj","fetchAdd","push","post","console","log","delItems","id","delete","filter","item","extraReducers","builder","addCase","fulfilled","reduce","sum","price","FULFILLED","pending","rejected","REJECTED","actions","selectBasket","basket","reducer"],"sources":["/Users/temirlan.kanafin/Desktop/git projects/reactt-sneakers/src/components/redux/slices/basketSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { RootState } from '../store';\n\n\n\nexport type productType = {\n  id: string;\n  productId: number;\n  title: string;\n  imageURL: string;\n  text: string;\n  price: number\n}\n\nexport enum Status {\n  LOADING = 'loading',\n  FULFILLED = 'success',\n  REJECTED = 'error',\n}\n\ninterface ProductState {\n  basketItems: productType[];\n  basketStatus: Status.LOADING | Status.FULFILLED | Status.REJECTED;\n  totalPrice: number;  \n}\nexport const fetchProductBasket = createAsyncThunk<productType[]>('basketSlice/fetchProductBasket', async () => {\n  const { data } = await axios.get<productType[]>('https://62b1bba0196a9e98703c1172.mockapi.io/card');\n  return data;\n});\n\nconst initialState: ProductState = {\n  basketItems: [],\n  basketStatus: Status.LOADING,\n  totalPrice: 0,\n};\n\nexport const ProductSlice = createSlice({\n  name: 'product',\n  initialState: initialState,\n  reducers: {\n    setItems: (state, action) => {\n      state.basketItems = action.payload;\n    },\n    addItems: (state, action) => {\n      const obj = action.payload;\n      async function fetchAdd() {\n        state.basketItems.push(obj)\n        await axios.post('https://62b1bba0196a9e98703c1172.mockapi.io/card', obj);\n        const { data } = await axios.get('https://62b1bba0196a9e98703c1172.mockapi.io/card');\n        state.basketItems = data\n      }\n      try {\n        fetchAdd()\n      } catch {\n        console.log('None')\n      }\n    },\n    delItems: (state, action) => {\n      const id = action.payload;\n      try {\n        axios.delete(`https://62b1bba0196a9e98703c1172.mockapi.io/card/${id}`);\n        state.basketItems = state.basketItems.filter((item) => item.id !== id);\n        const {data} = axios.get('https://62b1bba0196a9e98703c1172.mockapi.io/card')\n      } catch {\n        console.log('None')\n      }\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchProductBasket.fulfilled, (state, action: PayloadAction<productType[]>) => {\n      state.basketItems = action.payload;\n      state.totalPrice = state.basketItems.reduce((sum, obj) => {return sum + obj.price}, 0);\n      state.basketStatus = Status.FULFILLED;\n    });\n    builder.addCase(fetchProductBasket.pending, (state, action) => {\n      state.basketItems = [];\n      state.basketStatus = Status.LOADING;\n    });\n    builder.addCase(fetchProductBasket.rejected, (state, action) => {\n      state.basketItems = [];\n      state.basketStatus = Status.REJECTED;\n    });\n  }\n});\n\nexport const { setItems, addItems, delItems } = ProductSlice.actions;\nexport const selectBasket = (state: RootState) => state.basket;\nexport default ProductSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}